<!DOCTYPE html>
<html>
<head>
  <title>User Registration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body{ font-family:Arial; background:#111; color:#fff; text-align:center; padding-top:40px; }
    input,button{ padding:12px; margin:8px; width:80%; font-size:16px; }
    button{ background:#4caf50; border:none; font-weight:bold; cursor:pointer; }
    .box{ background:#222; width:90%; max-width:350px; padding:20px; margin:auto; border-radius:10px; }
  </style>
</head>

<body>

<h2>User Registration</h2>

<div class="box">
  <input id="mobile" type="text" placeholder="Mobile Number">
  <input id="password" type="password" placeholder="Password">

  <button onclick="registerUser()">Register</button>
  <p id="msg"></p>

  <a style="color:#0af" href="index.html">Already have account? Login</a>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAPFM1XnrX1A4cwQPCAkZ4sTMmnwORjx0A",
    authDomain: "ac-colour-prediction.firebaseapp.com",
    projectId: "ac-colour-prediction",
    storageBucket: "ac-colour-prediction.appspot.com",
    messagingSenderId: "471938348888",
    appId: "1:471938348888:web:ac3fc3eb1939eb7cbe172d"
  };

  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.firestore();

  async function registerUser(){
    const mobile = mobile.value;
    const pass   = password.value;

    if(mobile.length !== 10){
      msg.innerText = "Enter valid mobile number";
      return;
    }

    let fakeEmail = mobile + "@mobile.com";

    auth.createUserWithEmailAndPassword(fakeEmail, pass)
    .then(cred=>{
      return db.collection("users").doc(cred.user.uid).set({
        uid: cred.user.uid,
        mobile: mobile,
        coins: 1000,
        upi: "",
        bank: "",
        account: "",
        ifsc: "",
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });
    })
    .then(()=>{
      msg.innerText = "Registration successful!";
      location.href = "game.html";
    })
    .catch(e=> msg.innerText = e.message);
  }
</script>

</body>
</html>
