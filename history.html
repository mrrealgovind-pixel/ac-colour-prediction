<!DOCTYPE html>
<html>
<head>
  <title>Transaction History</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body{background:#111;color:#fff;font-family:Arial;text-align:center;padding:15px;}
    .item{background:#222;margin:10px;padding:12px;border-radius:8px;}
  </style>
</head>

<body>

<h2>Transaction History</h2>
<div id="list"></div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAPFM1XnrX1A4cwQPCAkZ4sTMmnwORjx0A",
  authDomain: "ac-colour-prediction.firebaseapp.com",
  projectId: "ac-colour-prediction",
  storageBucket: "ac-colour-prediction.appspot.com",
  messagingSenderId: "471938348888",
  appId: "1:471938348888:web:ac3fc3eb1939eb7cbe172d"
};
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.firestore();

auth.onAuthStateChanged(async (u)=>{
  if(!u){ location.href="index.html"; return; }

  const snap = await db.collection("transactions")
    .where("uid","==",u.uid)
    .orderBy("time","desc")
    .limit(50)
    .get();

  const list = document.getElementById("list");
  list.innerHTML = "";

  snap.forEach(doc=>{
    const d = doc.data();
    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <b>${d.type}</b> - ${d.amount} coins<br>
      <small>${d.time.toDate()}</small>
    `;
    list.appendChild(div);
  });
});
</script>

</body>
</html>
